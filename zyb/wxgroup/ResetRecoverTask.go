package wxgroup

import (
	"bytes"
	"encoding/json"
	"fmt"
	"io"
	"net/http"
	"strings"
)

func ResetRecoverTask() {
	//高中
	groupIds := "10723413328708632,10790631214795638,10880023896256504,10922426818180197,10822440409628426,10772222439043943,10699142039284225,10765359114208595,10798870516065303,10854270491164288,10863197166849870,10928664109210190,10747641707632527,10754675094416748,10856086888905958,10821926515999151,10797744873667298,10752628037750716,10738108616700793,10857057493065709,10773892917907691,10948214389389451,10796393427720982,10780570461918239,10830812936290362,10848817271110531,10729701773841508,10918115095132442,10740911563927823,10778551093561782,10971399059365232,10917957518944798,10819167961529011,10749051750479645,10779240199177573,10846093075758498,10768256291952896,10878827843306146,10909301644598997,10962449114194994,10824061362496628,10804305630457851,10931580331084534,10958721716248052,10778754581317541,10930266318235130,10959293243260409,10788787584866725,10795138860898195,10910323064519448,10877483836756287,10808873513728301,10968203601478436,10839555210665020,10876981382728582,10913002577076506,10937233796056756,10941511672266533,10939784696702559,10910958126163044,10796402447589109,10854715185157555,10883944048416256,10769520490123001,10900407539533001,10718995130931141,10881748094878675,10916595354437714,10872637276160756,10707195459410327,10901538671537328,10738797938684475,10802882704655950,10719106997763010,10877586067086408,10789139228898917,10729426014957780,10733498729842261,10823897875702739,10903513664339312,10933455545591263,10876076887872032,10727937505179328,10781875242276243,10874038733929470,10894255813423273,10838485435355679,10962864719438320,10944769271385873,10705622459188093,10903352736847277,10867136824500162,10871306521220405,10751262602041952,10882050986590602,10828513549240462,10751155487662903,10698295041647707,10904483309246049,10803956100381219,10724543848591777,10727072118456825,10775655238848953,10821713819488033,10763225931846776,10798343653715232,10894818385910711,10874792220778288,10951105224582873,10944214228484798,10930088838614272,10712922320054984,10805501195835358,10803830332199926,10895302100124543,10723010504566187,10952814883707497,10940311956062327,10762908505420129,10744219646650882,10737448833769128,10915783208719752,10926637715312695,10815146096795365,10833917171842344,10789491946475668,10749771537564685,10699618275349174,10802353451905444,10782403573836308,10763834346505765,10956715930919290,10863458091442644,10860680605589328,10934130778984381,10904891268039339,10706930203934575,10800441304697468,10704465775650152,10947076634211714,10720413662388561,10959578282704185,10960612554632686,10743132610140632,10805384612944421,10822702726448981,10940359540031794,10918891803965573,10913697283380514,10972432306606720,10892039514813144,10938309457563429,10905575615021058,10813990734298812,10714408879877285,10872129785411954,10886816878655946,10869919582102944,10859548889718795,10764497790671354,10776812981655450,10781901855921528,10944932793448221,10840187974003634,10903410965506565,10841491416624335,10945924551118165,10871143175184157,10775431850409286,10778422835898407,10781514161993046,10914409122550026,10702900381661350,10748884337977666,10780133762199755,10890593751602123,10844686633032407,10847271196324738,10924812604904479,10743640768704869,10780909662195999,10882230065168203,10962771323193662,10816735539834028,10748907727338090,10855660339891072,10770196131013215,10722631357186271,10853063281585256,10726235682365634,10836318677438360,10698572106810080,10865409994511982,10755459575937429,10966763894131323,10712191091128513,10787883331637250,10828040012695185,10739706921956967,10807052940865599,10793029226312455,10789300263919706,10898993618370306,10900586897382839,10717899285408861,10814548211579792,10791392268330643,10971060526329313,10909159012988514,10715512260860522,10909143207856423,10823794756946661,10824011366628224,10787481329219947,10725392619004886,10796540619618629,10908188001482179,10816462520458273,10719394732971242,10741211209918941,10833102148559589,10840778521010606,10867228603188407,10878460223973833,10974710394364107,10838914768194963,10844252909127231,10896902471152985,10707542489063253,10747728107135811,10887610126950997,10766713779412609,10709720298729409,10921580616486428,10950572464619477,10836870329828714,10728850946222516,10778444319158233,10873678542979876,10884602454031513,10810722908996295,10773322881008014,10726119382621569,10972207289115096,10924266676156690,10785811119013436,10745421973045987,10805301772423756,10880512289464201,10805704503575700,10729105095698912,10922115021016612,10737750337244487,10876432347786744,10949649806616961,10787870579867251,10903585192695930,10750793177359772,10913597499301868,10858159322545260,10774529297724362,10945467620814402,10802301400734293,10698621083307946,10794592352559633,10705668456207360,10835800331191878,10966336403434801,10878843713366130,10939291441652361,10891800553114152,10975708232975469,10728357918974466,10790274516104821,10963962242021188,10706386622332024,10858669320721835,10697104534239748,10747580480902898,10911998939623233,10793649814368581,10971102457849359,10766974063177653,10751348825821708,10904034935923186,10846352175576276,10941601253525874,10728644939512464,10829935428060662,10935597319817490,10765437929702705,10743365735966102,10744445500129000,10823066925978704,10853859894271725,10794135988417031,10711525324915452,10833430252065549,10957818094019126,10711501707493993,10831301372831912,10888217491744067,10805395260513624,10954039190077522,10834545991122561,10799934350879992,10799960040848149,10974058698025304,10965638637349384,10840349294061326,10852009124344323,10887003406536219,10797239646439084,10825634321489736,10826643606495399,10903179596690738,10912528603151354,10730337714786247,10776162566279282,10807539237225997,10777131270418668,10866246842565023,10773086704216931,10916991986908308,10762995213464965,10696879645925312,10864072663067522,10712814155494963,10835383648730513,10951911598142263,10801110923874828,10843754847805361,10848770720571622,10749430094639632,10773190151883422,10937850710488478,10902354674972781,10859837264457172,10742626855305776,10839838903048609,10889089296057077,10916546111230865,10776494968914894,10800109511156306,10753659311710154,10761083449100282,10810384402768338,10811648414308346,10818929878695010,10810632192975235,10833031406431594,10809113601023253,10875942945794606,10794665211145469,10745419044470237,10921984535501623,10949701695506153,10791058330088301,10943010584522046,10852077109334481,10891108877906245,10749066788642362,10949935544137484,10773022990345403,10722911044275795,10784707669968912,10966660987893175,10887907966777342,10853117974508986,10872257415184897,10816222791354941,10860242641467316,10699360260685545,10766233272910029,10752122802968911,10768145558868997,10744720882647629,10891760919179379,10923019355506568,10914313751363323,10917050388953973,10809418898570442,10820501767476282,10775605251071834,10898400608778635,10899232355508996,10873220689320206,10736172891606784,10700867032937174,10810653156074007,10930024048018204,10744714239763877,10953738574932919,10806182280686649,10900473606348837,10701441493729278,10862662642304196,10757593096888309,10706201950722094,10923261616905342,10773429281493468,10855215843045382,10909043476767845,10708718782271465,10814490752173693,10903606484133320,10977037460689579,10740572846827000,10771239458733275,10922177749746419,10861966951122257,10853255829602738,10783509047512898,10943693780349243,10960167579714251,10843485440682649,10717841611871729,10808565505889377,10837231094473525,10923758612623678,10964829161764144,10928865108033494,10929995241588152,10897429739745050,10904730245473114,10709213753402667,10734461305503128,10943066379034633,10862265839055816,10790614187619508,10744033597418694,10790388515557865,10898381841689203,10894951457269617,10920347546999435,10741187679352162,10862281300311853,10976564263868735,10934190681819600,10757884691547492,10969431905686254,10803269020177833,10766594925274003,10767428908682271,10889595360479401,10825593232353608,10893436905647514,10929193902376568,10714072322853243,10739604735326572,10921239228854628,10811117898237792,10901151917396757,10952913832007976,10748788942923588,10813025937292914,10778285571107672,10747088894174521,10797942521877778,10911295142663903,10885135747084833,10849070852417861,10912186692167943,10894954885701232,10873819503373555,10842678597319967,10702327512646331,10951109524653200,10894013292521005,10883436234625501,10816051933781038,10869931532429528,10907922865722957,10890230345751711,10712864367513652,10742501251865546,10809354533239646,10842366926413169,10856465814836010,10966812977168600,10721598841255063,10755019244381958,10881364143336571,10814008091635945,10967667093363968,10740849361627297,10960376107676118,10770412897937994,10905942120946146,10826089792488383,10814534304250427,10846946993437313,10749615599980303,10892895816166499,10927526319703535,10754571236161331,10780785948078457,10806513112256348,10737269963998072,10834675598800013,10925027151752862,10975355034772477,10810809013653800,10704361695543463,10758745891916751,10813426351973408,10725226522569071,10713319303759230,10879276793224002,10798889328393450,10728999312217452,10723367561784260,10934114278570780,10918254145095469,10775869755631368,10733435059857168,10819531935955825,10855822935558451,10826355424551586,10973822030121606,10880235057341646,10751747267762697,10941716201112890,10889684941798715,10768269557127495,10727184813681117,10816261427320541,10707534513864623,10884226845954639,10909787308343155,10743632898641730,10821278702476153,10871390893697907,10920062770391544,10923228341165608,10834745024433378,10762667264558076,10855696870980942,10960638382411212,10757523914583068,10859183846962918,10823468932837787,10962930492807578,10801692160235356,10897599336262140,10858524120003005,10840185002422987,10855929040957318,10737211014397291,10785411604882011,10732331451489408,10927358463509651,10798422005816599,10725248924215372,10891124992011429,10829730176660177,10755245079873808,10714801121891080,10919402650304341,10790290820738652"
	groupIdList := strings.Split(groupIds, ",")
	for _, groupId := range groupIdList {
		resetRecoverTaskv1(groupId)
	}

}

func resetRecoverTaskv1(wxGroupId string) {
	url := "https://wxtools.zuoyebang.cc/wxqk-go/tools/resetrecovergrouptask"

	// 设置请求参数
	params := map[string]interface{}{
		"wxGroupIds": wxGroupId,
	}

	// 将参数转换为JSON数据
	requestBody, err := json.Marshal(params)
	if err != nil {
		fmt.Println("Error marshalling request body:", err)
		return
	}

	// 创建POST请求
	req, err := http.NewRequest("POST", url, bytes.NewBuffer(requestBody))
	if err != nil {
		fmt.Println("Error creating request:", err)
		return
	}

	// 设置请求头
	req.Header.Set("Content-Type", "application/json")
	req.Header.Set("Cookie", "ZYBIPSCAS=IPS_db50e6b5e0d476e8084ca1adaa6e5be71723430461")

	// 发送请求
	client := &http.Client{}
	resp, err := client.Do(req)
	if err != nil {
		fmt.Println("Error sending request:", err)
		return
	}
	defer resp.Body.Close()

	// 打印响应状态码
	//fmt.Println("Response Status:", resp.Status)

	// 读取并打印响应体
	body, err := io.ReadAll(resp.Body)
	if err != nil {
		fmt.Println("Error reading response body:", err)
		return
	}

	//fmt.Println(string(body))

	// 解析响应体
	var response DismissResponse
	err = json.Unmarshal(body, &response)
	if err != nil {
		//fmt.Println("Error unmarshalling response body:", err)
		fmt.Printf("%s-,未找到群信息\n", wxGroupId)
		return
	}
	if response.ErrNo != 0 {
		fmt.Printf("%s-,重置失败\n", wxGroupId)
		return
	} else {
		fmt.Printf("%s-重置成功\n", wxGroupId)
		return
	}
}
